name: Taxonomy build & validation
on:
  workflow_dispatch:
  push:

env:
  TAX_NAME: rj_taxonomy_2024

jobs:
  build:
    runs-on: ubuntu-latest
    name: Build taxonomy-package
    steps:
      - uses: actions/checkout@v4
      - run: mkdir -p build

      - uses: montudor/action-zip@v1
        with:
          args: zip -r build/${{ env.TAX_NAME }}  ./${{ env.TAX_NAME }}
      # - run: './script/worker.sh '

      - uses: actions/upload-artifact@master
        with:
          name: ${{ env.TAX_NAME }}.zip
          path: build/${{ env.TAX_NAME }}.zip


  test:
    runs-on: ubuntu-latest
    name: Test taxonomy-package
    needs: build
    steps:
      - run: |
          pip install arelle-release
      - uses: actions/download-artifact@v4
        with:
          name: ${{ env.TAX_NAME }}.zip
          path: taxonomies
      - run: |
          arelleCmdLine --help
